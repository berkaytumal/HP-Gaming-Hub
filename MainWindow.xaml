<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="HP_Gaming_Hub.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:HP_Gaming_Hub"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="HP Gaming Hub">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Custom Title Bar -->
        <Grid x:Name="AppTitleBar" Grid.Row="0" Height="32">
            <Image Source="Assets/Square44x44Logo.targetsize-24_altform-unplated.png" 
                   HorizontalAlignment="Left" 
                   Width="16" Height="16" 
                   Margin="8,0"/> 
            <TextBlock x:Name="AppTitleTextBlock" Text="HP Gaming Hub" 
                       TextWrapping="NoWrap" 
                       Style="{StaticResource CaptionTextBlockStyle}" 
                       VerticalAlignment="Center" 
                       Margin="28,0,0,0"/> 
        </Grid>
        
        <!-- Main Content Area -->
        <Grid Grid.Row="1">
            <NavigationView x:Name="MainNavigationView" 
                           IsBackButtonVisible="Collapsed"
                           IsSettingsVisible="False"
                           OpenPaneLength="250"
                           CompactModeThresholdWidth="768"
                           ExpandedModeThresholdWidth="1008"
                           SelectedItem="{x:Bind MonitorNavItem}"
                           SelectionChanged="MainNavigationView_SelectionChanged">
                
                <NavigationView.MenuItems>
                     <NavigationViewItem x:Name="FanNavItem" Content="Fan">
                         <NavigationViewItem.Icon>
                             <ImageIcon Source="Assets/fan-icon.png"/>
                         </NavigationViewItem.Icon>
                     </NavigationViewItem>
                     
                     <NavigationViewItem x:Name="GraphicsNavItem" Content="Graphics">
                         <NavigationViewItem.Icon>
                             <ImageIcon Source="Assets/graphics-icon.png"/>
                         </NavigationViewItem.Icon>
                     </NavigationViewItem>
                     
                     <NavigationViewItem x:Name="KeyboardNavItem" Content="Keyboard">
                         <NavigationViewItem.Icon>
                             <ImageIcon Source="Assets/keyboard-icon.png"/>
                         </NavigationViewItem.Icon>
                     </NavigationViewItem>
                     
                     <NavigationViewItem x:Name="MonitorNavItem" Content="Monitor">
                         <NavigationViewItem.Icon>
                             <ImageIcon Source="Assets/monitor-icon.png"/>
                         </NavigationViewItem.Icon>
                     </NavigationViewItem>
                 </NavigationView.MenuItems>
                 
                 <NavigationView.FooterMenuItems>
                     <NavigationViewItem x:Name="SettingsNavItem" Content="Settings">
                         <NavigationViewItem.Icon>
                             <ImageIcon Source="Assets/settings-icon.png"/>
                         </NavigationViewItem.Icon>
                     </NavigationViewItem>
                 </NavigationView.FooterMenuItems>
                
                <!-- Main Content Area with Page Animation -->
                  <Grid Margin="24">
                     
                     <!-- Fan Page -->
                      <ScrollViewer x:Name="FanPage" Visibility="Collapsed">
                         <StackPanel Spacing="24" Padding="32">
                             <StackPanel Orientation="Horizontal" Spacing="16">
                                 <TextBlock Text="Fan Control" Style="{StaticResource TitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource AccentFillColorDefaultBrush}" CornerRadius="12" Padding="8,4">
                                     <TextBlock x:Name="FanConnectionStatusText" Text="Connected" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                 </Border>
                             </StackPanel>
                             <TextBlock Text="Control your system's cooling performance with manual fan speed adjustment and intelligent fan profiles powered by OmenMon." TextWrapping="Wrap"/>
                             
                             <!-- Fan Mode Selection -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Fan Mode" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <ComboBox x:Name="FanModeComboBox" Header="Select Fan Mode" SelectedIndex="0" SelectionChanged="FanModeComboBox_SelectionChanged">
                                     <ComboBoxItem Content="Default" Tag="Default"/>
                                     <ComboBoxItem Content="Performance" Tag="Performance"/>
                                     <ComboBoxItem Content="Cool" Tag="Cool"/>
                                     <ComboBoxItem Content="Manual" Tag="Manual"/>
                                 </ComboBox>
                             </StackPanel>
                             
                             <!-- Current Fan Status -->
                             <Grid>
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="*"/>
                                 </Grid.ColumnDefinitions>
                                 <StackPanel Grid.Column="0" Spacing="16" Margin="0,0,12,0">
                                     <TextBlock Text="Fan 1 Status" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Speed:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan1CurrentSpeedText" Text="-- RPM" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Level:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan1LevelText" Text="--" FontWeight="SemiBold"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Max Speed:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan1MaxSpeedText" Text="-- RPM" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                                 <StackPanel Grid.Column="1" Spacing="16" Margin="12,0,0,0">
                                     <TextBlock Text="Fan 2 Status" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Speed:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan2CurrentSpeedText" Text="-- RPM" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Level:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan2LevelText" Text="--" FontWeight="SemiBold"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Max Speed:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan2MaxSpeedText" Text="-- RPM" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                             </Grid>
                             
                             <!-- Manual Fan Control -->
                             <StackPanel x:Name="ManualFanControlPanel" Spacing="16" Visibility="Collapsed">
                                 <TextBlock Text="Manual Fan Speed Control" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <InfoBar x:Name="FanControlInfoBar" IsOpen="False" Severity="Warning" Title="Manual Control Active" Message="Manual fan control overrides automatic thermal management. Monitor temperatures carefully."/>
                                 
                                 <StackPanel Spacing="12">
                                     <Slider x:Name="Fan1SpeedSlider" Minimum="0" Maximum="255" Value="128" Header="Fan 1 Speed (0-255)" ValueChanged="Fan1SpeedSlider_ValueChanged"/>
                                     <TextBlock x:Name="Fan1SliderValueText" Text="Level: 128" Opacity="0.7"/>
                                 </StackPanel>
                                 
                                 <StackPanel Spacing="12">
                                     <Slider x:Name="Fan2SpeedSlider" Minimum="0" Maximum="255" Value="128" Header="Fan 2 Speed (0-255)" ValueChanged="Fan2SpeedSlider_ValueChanged"/>
                                     <TextBlock x:Name="Fan2SliderValueText" Text="Level: 128" Opacity="0.7"/>
                                 </StackPanel>
                                 
                                 <StackPanel Orientation="Horizontal" Spacing="16">
                                     <Button x:Name="ApplyFanSpeedButton" Content="Apply Settings" Click="ApplyFanSpeedButton_Click"/>
                                     <Button x:Name="ResetFanSpeedButton" Content="Reset to Auto" Click="ResetFanSpeedButton_Click"/>
                                 </StackPanel>
                             </StackPanel>
                             
                             <!-- Fan Curve Editor -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Advanced Settings" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <StackPanel Orientation="Horizontal" Spacing="16">
                                     <Button x:Name="MaxFanButton" Content="Enable Max Fan" Click="MaxFanButton_Click"/>
                                     <Button x:Name="RefreshFanDataButton" Content="Refresh Data" Click="RefreshFanDataButton_Click"/>
                                     <ToggleButton x:Name="FanMonitoringToggle" Content="Real-time Monitoring" IsChecked="True" Click="FanMonitoringToggle_Click"/>
                                 </StackPanel>
                             </StackPanel>
                         </StackPanel>
                     </ScrollViewer>
                     
                     <!-- Graphics Page -->
                      <ScrollViewer x:Name="GraphicsPage" Visibility="Collapsed">
                         <StackPanel Spacing="24" Padding="32">
                             <StackPanel Orientation="Horizontal" Spacing="16">
                                 <TextBlock Text="Graphics Settings" Style="{StaticResource TitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource AccentFillColorDefaultBrush}" CornerRadius="12" Padding="8,4">
                                     <TextBlock x:Name="GpuConnectionStatusText" Text="Connected" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                 </Border>
                             </StackPanel>
                             <TextBlock Text="Configure GPU performance settings, switch between graphics modes, and monitor GPU status using OmenMon integration." TextWrapping="Wrap"/>
                             
                             <!-- GPU Mode Selection -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="GPU Mode" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <ComboBox x:Name="GpuModeComboBox" Header="Select GPU Mode" SelectedIndex="0" SelectionChanged="GpuModeComboBox_SelectionChanged">
                                     <ComboBoxItem Content="Hybrid (Automatic)" Tag="Hybrid"/>
                                     <ComboBoxItem Content="Discrete (High Performance)" Tag="Discrete"/>
                                     <ComboBoxItem Content="Optimus (Balanced)" Tag="Optimus"/>
                                 </ComboBox>
                                 <TextBlock Text="Hybrid mode automatically switches between integrated and discrete GPU. Discrete mode uses dedicated GPU for maximum performance. Optimus provides balanced performance and battery life." TextWrapping="Wrap" Opacity="0.7" FontSize="12"/>
                             </StackPanel>
                             
                             <!-- GPU Performance Presets -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Performance Preset" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <ComboBox x:Name="GpuPresetComboBox" Header="Select Performance Preset" SelectedIndex="1" SelectionChanged="GpuPresetComboBox_SelectionChanged">
                                     <ComboBoxItem Content="Minimum (Power Saving)" Tag="Minimum"/>
                                     <ComboBoxItem Content="Medium (Balanced)" Tag="Medium"/>
                                     <ComboBoxItem Content="Maximum (Performance)" Tag="Maximum"/>
                                 </ComboBox>
                             </StackPanel>
                             
                             <!-- Current GPU Status -->
                             <Grid>
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="*"/>
                                 </Grid.ColumnDefinitions>
                                 <StackPanel Grid.Column="0" Spacing="16" Margin="0,0,12,0">
                                     <TextBlock Text="Current GPU Status" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Active Mode:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="CurrentGpuModeText" Text="Unknown" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Preset:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="CurrentGpuPresetText" Text="Unknown" FontWeight="SemiBold"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Temperature:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="CurrentGpuTempText" Text="--°C" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                                 <StackPanel Grid.Column="1" Spacing="16" Margin="12,0,0,0">
                                     <TextBlock Text="Power Limits" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="CPU Power Limit 1 (PL1)" FontWeight="SemiBold"/>
                                                 <Slider x:Name="CpuPL1Slider" Minimum="15" Maximum="45" Value="25" Header="Watts" ValueChanged="CpuPL1Slider_ValueChanged"/>
                                                 <TextBlock x:Name="CpuPL1ValueText" Text="25W" Opacity="0.7" FontSize="12"/>
                                             </StackPanel>
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="CPU Power Limit 4 (PL4)" FontWeight="SemiBold"/>
                                                 <Slider x:Name="CpuPL4Slider" Minimum="35" Maximum="65" Value="45" Header="Watts" ValueChanged="CpuPL4Slider_ValueChanged"/>
                                                 <TextBlock x:Name="CpuPL4ValueText" Text="45W" Opacity="0.7" FontSize="12"/>
                                             </StackPanel>
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="GPU Power Limit" FontWeight="SemiBold"/>
                                                 <Slider x:Name="GpuPLSlider" Minimum="50" Maximum="150" Value="100" Header="Watts" ValueChanged="GpuPLSlider_ValueChanged"/>
                                                 <TextBlock x:Name="GpuPLValueText" Text="100W" Opacity="0.7" FontSize="12"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                             </Grid>
                             
                             <!-- Advanced GPU Settings -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Advanced Settings" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <StackPanel Orientation="Horizontal" Spacing="16">
                                     <ToggleSwitch x:Name="XmpToggle" Header="XMP Profile" OnContent="Enabled" OffContent="Disabled" Toggled="XmpToggle_Toggled"/>
                                     <Button x:Name="ApplyGpuSettingsButton" Content="Apply Settings" Click="ApplyGpuSettingsButton_Click"/>
                                     <Button x:Name="RefreshGpuDataButton" Content="Refresh Data" Click="RefreshGpuDataButton_Click"/>
                                 </StackPanel>
                                 
                                 <InfoBar x:Name="GpuSettingsInfoBar" IsOpen="False" Severity="Informational" Title="Settings Applied" Message="GPU settings have been applied successfully. Changes may require a system restart to take full effect."/>
                             </StackPanel>
                         </StackPanel>
                     </ScrollViewer>
                     
                     <!-- Keyboard Page -->
                      <ScrollViewer x:Name="KeyboardPage" Visibility="Collapsed">
                         <StackPanel Spacing="24" Padding="32">
                             <StackPanel Orientation="Horizontal" Spacing="16">
                                 <TextBlock Text="Keyboard Settings" Style="{StaticResource TitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource AccentFillColorDefaultBrush}" CornerRadius="12" Padding="8,4">
                                     <TextBlock x:Name="KeyboardConnectionStatusText" Text="Connected" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                 </Border>
                             </StackPanel>
                             <TextBlock Text="Configure keyboard backlight settings, RGB colors, and animations using OmenMon integration. Customize your gaming experience with personalized lighting effects." TextWrapping="Wrap"/>
                             
                             <!-- Backlight Control -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Backlight Control" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <ToggleSwitch x:Name="BacklightToggle" Header="Keyboard Backlight" OnContent="Enabled" OffContent="Disabled" Toggled="BacklightToggle_Toggled"/>
                                 <TextBlock Text="Enable or disable the keyboard backlight. When disabled, all RGB effects will be turned off." TextWrapping="Wrap" Opacity="0.7" FontSize="12"/>
                             </StackPanel>
                             
                             <!-- Color Presets -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Color Presets" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <ComboBox x:Name="ColorPresetComboBox" Header="Select Color Preset" SelectedIndex="0" SelectionChanged="ColorPresetComboBox_SelectionChanged">
                                     <ComboBoxItem Content="Red" Tag="Red"/>
                                     <ComboBoxItem Content="Green" Tag="Green"/>
                                     <ComboBoxItem Content="Blue" Tag="Blue"/>
                                     <ComboBoxItem Content="Yellow" Tag="Yellow"/>
                                     <ComboBoxItem Content="Purple" Tag="Purple"/>
                                     <ComboBoxItem Content="Cyan" Tag="Cyan"/>
                                     <ComboBoxItem Content="White" Tag="White"/>
                                     <ComboBoxItem Content="Orange" Tag="Orange"/>
                                     <ComboBoxItem Content="Custom" Tag="Custom"/>
                                 </ComboBox>
                             </StackPanel>
                             
                             <!-- Custom Color Settings -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Custom RGB Colors" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <StackPanel Grid.Column="0" Spacing="16" Margin="0,0,12,0">
                                         <TextBlock Text="Zone Colors" FontWeight="SemiBold"/>
                                         <StackPanel Spacing="12">
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="Zone 1 (RGB)" FontWeight="SemiBold"/>
                                                 <StackPanel Orientation="Horizontal" Spacing="8">
                                                     <Slider x:Name="Zone1RedSlider" Minimum="0" Maximum="255" Value="255" Header="R" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone1GreenSlider" Minimum="0" Maximum="255" Value="0" Header="G" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone1BlueSlider" Minimum="0" Maximum="255" Value="0" Header="B" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Border x:Name="Zone1ColorPreview" Width="40" Height="30" CornerRadius="4" Background="Red"/>
                                                 </StackPanel>
                                             </StackPanel>
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="Zone 2 (RGB)" FontWeight="SemiBold"/>
                                                 <StackPanel Orientation="Horizontal" Spacing="8">
                                                     <Slider x:Name="Zone2RedSlider" Minimum="0" Maximum="255" Value="0" Header="R" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone2GreenSlider" Minimum="0" Maximum="255" Value="255" Header="G" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone2BlueSlider" Minimum="0" Maximum="255" Value="0" Header="B" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Border x:Name="Zone2ColorPreview" Width="40" Height="30" CornerRadius="4" Background="Green"/>
                                                 </StackPanel>
                                             </StackPanel>
                                         </StackPanel>
                                     </StackPanel>
                                     <StackPanel Grid.Column="1" Spacing="16" Margin="12,0,0,0">
                                         <TextBlock Text="Zone Colors (Continued)" FontWeight="SemiBold"/>
                                         <StackPanel Spacing="12">
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="Zone 3 (RGB)" FontWeight="SemiBold"/>
                                                 <StackPanel Orientation="Horizontal" Spacing="8">
                                                     <Slider x:Name="Zone3RedSlider" Minimum="0" Maximum="255" Value="0" Header="R" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone3GreenSlider" Minimum="0" Maximum="255" Value="0" Header="G" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone3BlueSlider" Minimum="0" Maximum="255" Value="255" Header="B" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Border x:Name="Zone3ColorPreview" Width="40" Height="30" CornerRadius="4" Background="Blue"/>
                                                 </StackPanel>
                                             </StackPanel>
                                             <StackPanel Spacing="8">
                                                 <TextBlock Text="Zone 4 (RGB)" FontWeight="SemiBold"/>
                                                 <StackPanel Orientation="Horizontal" Spacing="8">
                                                     <Slider x:Name="Zone4RedSlider" Minimum="0" Maximum="255" Value="255" Header="R" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone4GreenSlider" Minimum="0" Maximum="255" Value="255" Header="G" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Slider x:Name="Zone4BlueSlider" Minimum="0" Maximum="255" Value="0" Header="B" Width="80" ValueChanged="ColorSlider_ValueChanged"/>
                                                     <Border x:Name="Zone4ColorPreview" Width="40" Height="30" CornerRadius="4" Background="Yellow"/>
                                                 </StackPanel>
                                             </StackPanel>
                                         </StackPanel>
                                     </StackPanel>
                                 </Grid>
                             </StackPanel>
                             
                             <!-- Animation Settings -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Animation Effects" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <ComboBox x:Name="AnimationComboBox" Header="Select Animation" SelectedIndex="0" SelectionChanged="AnimationComboBox_SelectionChanged">
                                     <ComboBoxItem Content="Static" Tag="Static"/>
                                     <ComboBoxItem Content="Breathing" Tag="Breathing"/>
                                     <ComboBoxItem Content="Wave" Tag="Wave"/>
                                     <ComboBoxItem Content="Rainbow" Tag="Rainbow"/>
                                     <ComboBoxItem Content="Custom" Tag="Custom"/>
                                 </ComboBox>
                                 <TextBlock Text="Choose from predefined animation effects or create custom patterns. Some animations may override individual zone colors." TextWrapping="Wrap" Opacity="0.7" FontSize="12"/>
                             </StackPanel>
                             
                             <!-- Control Buttons -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Actions" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <StackPanel Orientation="Horizontal" Spacing="16">
                                     <Button x:Name="ApplyKeyboardSettingsButton" Content="Apply Settings" Click="ApplyKeyboardSettingsButton_Click"/>
                                     <Button x:Name="RefreshKeyboardDataButton" Content="Refresh Data" Click="RefreshKeyboardDataButton_Click"/>
                                     <Button x:Name="ResetKeyboardButton" Content="Reset to Default" Click="ResetKeyboardButton_Click"/>
                                 </StackPanel>
                                 
                                 <InfoBar x:Name="KeyboardSettingsInfoBar" IsOpen="False" Severity="Informational" Title="Settings Applied" Message="Keyboard settings have been applied successfully."/>
                             </StackPanel>
                         </StackPanel>
                     </ScrollViewer>
                     
                     <!-- Monitor Page (Default) -->
                      <ScrollViewer x:Name="MonitorPage" Visibility="Visible">
                         <StackPanel Spacing="24" Padding="32">
                             <StackPanel Orientation="Horizontal" Spacing="16">
                                 <TextBlock Text="System Monitor" Style="{StaticResource TitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource AccentFillColorDefaultBrush}" CornerRadius="12" Padding="8,4">
                                     <TextBlock x:Name="ConnectionStatusText" Text="Connecting..." Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                 </Border>
                             </StackPanel>
                             <TextBlock Text="Real-time hardware monitoring powered by OmenMon utility. Monitor temperatures, fan speeds, and system performance." TextWrapping="Wrap"/>
                             
                             <!-- Status and Controls -->
                             <StackPanel Orientation="Horizontal" Spacing="16">
                                 <Button x:Name="RefreshButton" Content="Refresh" Click="RefreshButton_Click"/>
                                 <ToggleButton x:Name="MonitoringToggle" Content="Auto Monitor" IsChecked="True" Click="MonitoringToggle_Click"/>
                                 <TextBlock x:Name="LastUpdateText" Text="Last Update: Never" VerticalAlignment="Center" Opacity="0.7"/>
                             </StackPanel>
                             
                             <!-- Temperature Monitoring -->
                             <Grid>
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="*"/>
                                 </Grid.ColumnDefinitions>
                                 <StackPanel Grid.Column="0" Spacing="16" Margin="0,0,12,0">
                                     <TextBlock Text="Temperature Monitoring" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="CPU:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="CpuTempText" Text="--°C" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="GPU:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="GpuTempText" Text="--°C" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Status:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="TempStatusText" Text="Normal" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                                 <StackPanel Grid.Column="1" Spacing="16" Margin="12,0,0,0">
                                     <TextBlock Text="Fan Monitoring" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Fan 1:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan1SpeedText" Text="-- RPM" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Fan 2:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="Fan2SpeedText" Text="-- RPM" FontWeight="SemiBold" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Mode:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="FanModeText" Text="Auto" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                             </Grid>
                             
                             <!-- GPU and System Info -->
                             <Grid>
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="*"/>
                                 </Grid.ColumnDefinitions>
                                 <StackPanel Grid.Column="0" Spacing="16" Margin="0,0,12,0">
                                     <TextBlock Text="GPU Information" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="12">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Mode:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="GpuModeText" Text="Unknown" FontWeight="SemiBold"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Preset:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="GpuPresetText" Text="Unknown" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                                 <StackPanel Grid.Column="1" Spacing="16" Margin="12,0,0,0">
                                     <TextBlock Text="System Status" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                     <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                         <StackPanel Spacing="8">
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Overclock:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="OverclockStatusText" Text="No" FontWeight="SemiBold"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Memory OC:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="MemoryOcStatusText" Text="No" FontWeight="SemiBold"/>
                                             </StackPanel>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <TextBlock Text="Undervolt:" FontWeight="SemiBold"/>
                                                 <TextBlock x:Name="UndervoltStatusText" Text="No" FontWeight="SemiBold"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Border>
                                 </StackPanel>
                             </Grid>
                         </StackPanel>
                     </ScrollViewer>
                     
                     <!-- Settings Page -->
                      <ScrollViewer x:Name="SettingsPage" Visibility="Collapsed">
                         <StackPanel Spacing="24" Padding="32">
                             <StackPanel Orientation="Horizontal" Spacing="16">
                                 <TextBlock Text="Settings" Style="{StaticResource TitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource AccentFillColorDefaultBrush}" CornerRadius="12" Padding="8,4">
                                     <TextBlock x:Name="SettingsConnectionStatusText" Text="Connected" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                 </Border>
                             </StackPanel>
                             <TextBlock Text="Configure application settings, BIOS options, and system management preferences." TextWrapping="Wrap"/>
                             
                             <!-- Application Settings -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Application Settings" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                     <StackPanel Spacing="12">
                                         <ToggleSwitch x:Name="StartWithWindowsToggle" Header="Start with Windows" IsOn="False" Toggled="StartWithWindowsToggle_Toggled"/>
                                         <ToggleSwitch x:Name="MinimizeToTrayToggle" Header="Minimize to System Tray" IsOn="True" Toggled="MinimizeToTrayToggle_Toggled"/>
                                         <ToggleSwitch x:Name="AutoRefreshToggle" Header="Auto-refresh monitoring data" IsOn="True" Toggled="AutoRefreshToggle_Toggled"/>
                                         <ComboBox x:Name="ThemeComboBox" Header="Theme" SelectedIndex="0" SelectionChanged="ThemeComboBox_SelectionChanged">
                                             <ComboBoxItem Content="System Default" Tag="Default"/>
                                             <ComboBoxItem Content="Light" Tag="Light"/>
                                             <ComboBoxItem Content="Dark" Tag="Dark"/>
                                         </ComboBox>
                                         <ComboBox x:Name="RefreshIntervalComboBox" Header="Monitoring Refresh Interval" SelectedIndex="1" SelectionChanged="RefreshIntervalComboBox_SelectionChanged">
                                             <ComboBoxItem Content="1 second" Tag="1000"/>
                                             <ComboBoxItem Content="2 seconds" Tag="2000"/>
                                             <ComboBoxItem Content="5 seconds" Tag="5000"/>
                                             <ComboBoxItem Content="10 seconds" Tag="10000"/>
                                         </ComboBox>
                                     </StackPanel>
                                 </Border>
                             </StackPanel>
                             
                             <!-- BIOS Settings -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="BIOS Settings" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                     <StackPanel Spacing="12">
                                         <ToggleSwitch x:Name="BiosBacklightToggle" Header="Keyboard Backlight" IsOn="True" Toggled="BiosBacklightToggle_Toggled"/>
                                         <ToggleSwitch x:Name="BiosFanMaxToggle" Header="Maximum Fan Speed" IsOn="False" Toggled="BiosFanMaxToggle_Toggled"/>
                                         <ToggleSwitch x:Name="BiosOverclockToggle" Header="Overclocking Support" IsOn="False" Toggled="BiosOverclockToggle_Toggled"/>
                                         <ToggleSwitch x:Name="BiosMemoryOverclockToggle" Header="Memory Overclocking" IsOn="False" Toggled="BiosMemoryOverclockToggle_Toggled"/>
                                         <ToggleSwitch x:Name="BiosUndervoltToggle" Header="CPU Undervolting" IsOn="False" Toggled="BiosUndervoltToggle_Toggled"/>
                                         <ComboBox x:Name="BiosFanModeComboBox" Header="Default Fan Mode" SelectedIndex="0" SelectionChanged="BiosFanModeComboBox_SelectionChanged">
                                             <ComboBoxItem Content="Auto" Tag="auto"/>
                                             <ComboBoxItem Content="Manual" Tag="manual"/>
                                             <ComboBoxItem Content="Performance" Tag="performance"/>
                                             <ComboBoxItem Content="Quiet" Tag="quiet"/>
                                         </ComboBox>
                                         <Button x:Name="ApplyBiosSettingsButton" Content="Apply BIOS Settings" Click="ApplyBiosSettingsButton_Click" HorizontalAlignment="Left"/>
                                     </StackPanel>
                                 </Border>
                             </StackPanel>
                             
                             <!-- Task Management -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="Task Management" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                     <StackPanel Spacing="12">
                                         <StackPanel Orientation="Horizontal" Spacing="12">
                                             <Button x:Name="RestartOmenMonButton" Content="Restart OmenMon Service" Click="RestartOmenMonButton_Click"/>
                                             <Button x:Name="CheckOmenMonStatusButton" Content="Check Service Status" Click="CheckOmenMonStatusButton_Click"/>
                                         </StackPanel>
                                         <StackPanel Orientation="Horizontal" Spacing="12">
                                             <Button x:Name="ClearLogsButton" Content="Clear Application Logs" Click="ClearLogsButton_Click"/>
                                             <Button x:Name="ExportSettingsButton" Content="Export Settings" Click="ExportSettingsButton_Click"/>
                                             <Button x:Name="ImportSettingsButton" Content="Import Settings" Click="ImportSettingsButton_Click"/>
                                         </StackPanel>
                                         <ToggleSwitch x:Name="DebugModeToggle" Header="Debug Mode" IsOn="False" Toggled="DebugModeToggle_Toggled"/>
                                         <TextBlock Text="Debug mode enables detailed logging and diagnostic information." TextWrapping="Wrap" Opacity="0.7" FontSize="12"/>
                                     </StackPanel>
                                 </Border>
                             </StackPanel>
                             
                             <!-- System Information -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="System Information" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                     <StackPanel Spacing="12">
                                         <StackPanel Orientation="Horizontal" Spacing="8">
                                             <TextBlock Text="OmenMon Version:" FontWeight="SemiBold"/>
                                             <TextBlock x:Name="OmenMonVersionText" Text="Unknown" FontWeight="SemiBold"/>
                                         </StackPanel>
                                         <StackPanel Orientation="Horizontal" Spacing="8">
                                             <TextBlock Text="Application Version:" FontWeight="SemiBold"/>
                                             <TextBlock x:Name="AppVersionText" Text="1.0.0" FontWeight="SemiBold"/>
                                         </StackPanel>
                                         <StackPanel Orientation="Horizontal" Spacing="8">
                                             <TextBlock Text="System Born Date:" FontWeight="SemiBold"/>
                                             <TextBlock x:Name="SystemBornDateText" Text="Unknown" FontWeight="SemiBold"/>
                                         </StackPanel>
                                         <StackPanel Orientation="Horizontal" Spacing="8">
                                             <TextBlock Text="Adapter Info:" FontWeight="SemiBold"/>
                                             <TextBlock x:Name="AdapterInfoText" Text="Unknown" FontWeight="SemiBold"/>
                                         </StackPanel>
                                         <Button x:Name="RefreshSystemInfoButton" Content="Refresh System Info" Click="RefreshSystemInfoButton_Click" HorizontalAlignment="Left"/>
                                     </StackPanel>
                                 </Border>
                             </StackPanel>
                             
                             <!-- About Section -->
                             <StackPanel Spacing="16">
                                 <TextBlock Text="About" Style="{StaticResource SubtitleTextBlockStyle}"/>
                                 <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                                     <StackPanel Spacing="12">
                                         <TextBlock Text="HP Gaming Hub" FontWeight="Bold" FontSize="16"/>
                                         <TextBlock Text="A comprehensive hardware monitoring and control application for HP gaming laptops, powered by OmenMon utility." TextWrapping="Wrap"/>
                                         <StackPanel Orientation="Horizontal" Spacing="12">
                                             <Button x:Name="CheckUpdatesButton" Content="Check for Updates" Click="CheckUpdatesButton_Click"/>
                                             <Button x:Name="ViewLogsButton" Content="View Application Logs" Click="ViewLogsButton_Click"/>
                                         </StackPanel>
                                     </StackPanel>
                                 </Border>
                             </StackPanel>
                             
                             <InfoBar x:Name="SettingsInfoBar" IsOpen="False" Severity="Informational" Title="Settings" Message="Settings have been applied successfully."/>
                         </StackPanel>
                     </ScrollViewer>
                 </Grid>
                
            </NavigationView>
        </Grid>
    </Grid>
</Window>
